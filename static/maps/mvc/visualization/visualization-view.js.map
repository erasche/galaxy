{"version":3,"sources":["mvc/visualization/visualization-view.js"],"names":["View","Backbone","extend","initialize","options","self","setElement","$","model","Model","ajax","url","Galaxy","root","dataset_id","done","dataset","visualizations","length","$el","append","addClass","text","set","render","get","vis_index","vis_array","_","each","sort","a","b","html","v","id","dict","name","keywords","title","image_src","logo","description","regular","visualization","push","types","title_default","title_list","collection","onclick","vis_type","attr","href","empty"],"mappings":";;;;;;;;;;;;;;;AAIA,QAAIA,OAAOC,SAASD,IAAT,CAAcE,MAAd,CAAqB;AAC5BC,oBAAY,oBAASC,OAAT,EAAkB;AAC1B,gBAAIC,OAAO,IAAX;AACA,iBAAKC,UAAL,CAAgBC,EAAE,QAAF,CAAhB;AACA,iBAAKC,KAAL,GAAa,IAAIP,SAASQ,KAAb,EAAb;AACAF,cAAEG,IAAF,CAAO;AACHC,qBAAQC,OAAOC,IAAf,qBAAmCT,QAAQU;AADxC,aAAP,EAEGC,IAFH,CAEQ,mBAAW;AACf,oBAAIC,QAAQC,cAAR,CAAuBC,MAAvB,KAAkC,CAAtC,EAAyC;AACrCb,yBAAKc,GAAL,CAASC,MAAT,CACIb,EAAE,QAAF,EACKc,QADL,CACc,mBADd,EAEKD,MAFL,CAGQb,EAAE,MAAF,EAAUe,IAAV,CACI,sIADJ,CAHR,CADJ;AASH,iBAVD,MAUO;AACHjB,yBAAKG,KAAL,CAAWe,GAAX,CAAe,EAAEP,SAASA,OAAX,EAAf;AACAX,yBAAKmB,MAAL;AACH;AACJ,aAjBD;AAkBH,SAvB2B;;AAyB5BA,gBAAQ,kBAAW;AACf,gBAAInB,OAAO,IAAX;AACA,gBAAIW,UAAU,KAAKR,KAAL,CAAWiB,GAAX,CAAe,SAAf,CAAd;AACA,iBAAKC,SAAL,GAAiB,EAAjB;AACA,iBAAKC,SAAL,GAAiB,EAAjB;AACAC,cAAEC,IAAF,CACIb,QAAQC,cAAR,CAAuBa,IAAvB,CAA4B,UAASC,CAAT,EAAYC,CAAZ,EAAe;AACvC,uBAAOD,EAAEE,IAAF,GAASD,EAAEC,IAAX,GAAkB,CAAC,CAAnB,GAAuB,CAA9B;AACH,aAFD,CADJ,EAII,UAASC,CAAT,EAAYC,EAAZ,EAAgB;AACZ,oBAAIC,OAAO;AACPD,wBAAIA,EADG;AAEPE,0BAAMH,EAAEG,IAFD;AAGPC,8BAAUJ,EAAEI,QAAF,IAAc,EAHjB;AAIPC,2BAAOL,EAAED,IAJF;AAKPO,+BAAWN,EAAEO,IAAF,GAAS7B,OAAOC,IAAP,GAAcqB,EAAEO,IAAzB,GAAgC,IALpC;AAMPC,iCAAaR,EAAEQ,WAAF,IAAiB,2BANvB;AAOPC,6BAAST,EAAES,OAPJ;AAQPC,mCAAeV;AARR,iBAAX;AAUA7B,qBAAKqB,SAAL,CAAeU,KAAKD,EAApB,IAA0BC,IAA1B;AACA/B,qBAAKsB,SAAL,CAAekB,IAAf,CAAoBT,IAApB;AACH,aAjBL;AAmBA,iBAAKU,KAAL,GAAa,IAAI,uBAAW9C,IAAf,CAAoB;AAC7B+C,+BAAe,mBADc;AAE7BC,4BAAY,2BAFiB;AAG7BC,4BAAY,KAAKtB,SAHY;AAI7BuB,yBAAS,iBAASf,EAAT,EAAa;AAClB,wBAAIgB,WAAW9C,KAAKqB,SAAL,CAAeS,EAAf,CAAf;AACA5B,sBAAE,cAAF,EAAkB6C,IAAlB,CAAuB,KAAvB,EAA8BD,SAASP,aAAT,CAAuBS,IAArD;AACH;AAP4B,aAApB,CAAb;AASA,iBAAKlC,GAAL,CAASmC,KAAT,GAAiBlC,MAAjB,CAAwB,KAAK0B,KAAL,CAAW3B,GAAnC;AACH;AA3D2B,KAArB,CAAX,C,CAJA;;;sBAiEe,EAAEnB,MAAMA,IAAR,E","file":"../../../scripts/mvc/visualization/visualization-view.js","sourcesContent":["/**\n *  Visualization selection grid\n */\nimport Thumbnails from \"mvc/ui/ui-thumbnails\";\nvar View = Backbone.View.extend({\n    initialize: function(options) {\n        var self = this;\n        this.setElement($(\"<div/>\"));\n        this.model = new Backbone.Model();\n        $.ajax({\n            url: `${Galaxy.root}api/datasets/${options.dataset_id}`\n        }).done(dataset => {\n            if (dataset.visualizations.length === 0) {\n                self.$el.append(\n                    $(\"<div/>\")\n                        .addClass(\"errormessagelarge\")\n                        .append(\n                            $(\"<p/>\").text(\n                                \"Unfortunately we could not identify a suitable plugin. Feel free to contact us if you are aware of visualizations for this datatype.\"\n                            )\n                        )\n                );\n            } else {\n                self.model.set({ dataset: dataset });\n                self.render();\n            }\n        });\n    },\n\n    render: function() {\n        var self = this;\n        var dataset = this.model.get(\"dataset\");\n        this.vis_index = {};\n        this.vis_array = [];\n        _.each(\n            dataset.visualizations.sort(function(a, b) {\n                return a.html < b.html ? -1 : 1;\n            }),\n            function(v, id) {\n                var dict = {\n                    id: id,\n                    name: v.name,\n                    keywords: v.keywords || [],\n                    title: v.html,\n                    image_src: v.logo ? Galaxy.root + v.logo : null,\n                    description: v.description || \"No description available.\",\n                    regular: v.regular,\n                    visualization: v\n                };\n                self.vis_index[dict.id] = dict;\n                self.vis_array.push(dict);\n            }\n        );\n        this.types = new Thumbnails.View({\n            title_default: \"Suggested plugins\",\n            title_list: \"List of available plugins\",\n            collection: this.vis_array,\n            onclick: function(id) {\n                var vis_type = self.vis_index[id];\n                $(\"#galaxy_main\").attr(\"src\", vis_type.visualization.href);\n            }\n        });\n        this.$el.empty().append(this.types.$el);\n    }\n});\nexport default { View: View };\n"]}