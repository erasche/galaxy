{"version":3,"sources":["mvc/ui/ui-popover.js"],"names":["Backbone","_","View","extend","optionsDefault","with_close","title","placement","container","body","initialize","options","setElement","_template","uid","defaults","parent","append","el","$title","$","$close","$body","self","on","visible","is","e","target","has","length","hide","render","html","$el","removeClass","addClass","css","_get_placement","show","off","newTitle","undefined","empty","remove","width","_get_width","height","$container","container_width","container_height","_get_height","container_position","position","top","left","indexOf","parseInt"],"mappings":"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","file":"../../../scripts/mvc/ui/ui-popover.js","sourcesContent":["/**\n * Popover wrapper\n */\nimport * as Backbone from \"backbone\";\nimport * as _ from \"underscore\";\nimport Utils from \"utils/utils\";\n\n/* global $ */\n\nvar View = Backbone.View.extend({\n    optionsDefault: {\n        with_close: true,\n        title: null,\n        placement: \"top\",\n        container: \"body\",\n        body: null\n    },\n\n    initialize: function(options) {\n        this.setElement(this._template());\n        this.uid = Utils.uid();\n        this.options = _.defaults(options || {}, this.optionsDefault);\n        this.options.container.parent().append(this.el);\n        this.$title = this.$(\".popover-title-label\");\n        this.$close = this.$(\".popover-close\");\n        this.$body = this.$(\".popover-content\");\n\n        // add initial content\n        if (this.options.body) {\n            this.append(this.options.body);\n        }\n\n        // add event to hide if click is outside of popup and not on container\n        var self = this;\n        $(\"body\").on(`mousedown.${this.uid}`, e => {\n            // the 'is' for buttons that trigger popups\n            // the 'has' for icons within a button that triggers a popup\n            if (\n                self.visible &&\n                !$(self.options.container).is(e.target) &&\n                !$(self.el).is(e.target) &&\n                $(self.el).has(e.target).length === 0\n            ) {\n                self.hide();\n            }\n        });\n    },\n\n    /**\n     * Render popover\n     */\n    render: function() {\n        this.$title.html(this.options.title);\n        this.$el\n            .removeClass()\n            .addClass(\"ui-popover popover in\")\n            .addClass(this.options.placement);\n        this.$el.css(this._get_placement(this.options.placement));\n\n        // configure close option\n        var self = this;\n        if (this.options.with_close) {\n            this.$close\n                .on(\"click\", () => {\n                    self.hide();\n                })\n                .show();\n        } else {\n            this.$close.off().hide();\n        }\n    },\n\n    /**\n     * Set the popover title\n     * @params{ String }    newTitle    - New popover title\n     */\n    title: function(newTitle) {\n        if (newTitle !== undefined) {\n            this.options.title = newTitle;\n            this.$title.html(newTitle);\n        }\n    },\n\n    /**\n     * Show popover\n     */\n    show: function() {\n        this.render();\n        this.$el.show();\n        this.visible = true;\n    },\n\n    /**\n     * Hide popover\n     */\n    hide: function() {\n        this.$el.hide();\n        this.visible = false;\n    },\n\n    /**\n     * Append new content to the popover\n     * @params{ Object }  $el - Dom element\n     */\n    append: function($el) {\n        this.$body.append($el);\n    },\n\n    /**\n     * Remove all content\n     */\n    empty: function() {\n        this.$body.empty();\n    },\n\n    /**\n     * Remove popover\n     */\n    remove: function() {\n        $(\"body\").off(`mousedown.${this.uid}`);\n        this.$el.remove();\n    },\n\n    /**\n     * Improve popover location/placement\n     */\n    _get_placement: function(placement) {\n        // get popover dimensions\n        var width = this._get_width(this.$el);\n        var height = this.$el.height();\n\n        // get container details\n        var $container = this.options.container;\n        var container_width = this._get_width($container);\n        var container_height = this._get_height($container);\n        var container_position = $container.position();\n\n        // get position\n        var top;\n\n        var left;\n        top = left = 0;\n        if ([\"top\", \"bottom\"].indexOf(placement) != -1) {\n            left = container_position.left - width + (container_width + width) / 2;\n            switch (placement) {\n                case \"top\":\n                    top = container_position.top - height - 5;\n                    break;\n                case \"bottom\":\n                    top = container_position.top + container_height + 5;\n                    break;\n            }\n        } else {\n            top = container_position.top - height + (container_height + height) / 2;\n            switch (placement) {\n                case \"right\":\n                    left = container_position.left + container_width;\n                    break;\n            }\n        }\n        return { top: top, left: left };\n    },\n\n    /**\n     * Returns padding/margin corrected width\n     */\n    _get_width: function($el) {\n        return (\n            $el.width() +\n            parseInt($el.css(\"padding-left\")) +\n            parseInt($el.css(\"margin-left\")) +\n            parseInt($el.css(\"padding-right\")) +\n            parseInt($el.css(\"margin-right\"))\n        );\n    },\n\n    /**\n     * Returns padding corrected height\n     */\n    _get_height: function($el) {\n        return $el.height() + parseInt($el.css(\"padding-top\")) + parseInt($el.css(\"padding-bottom\"));\n    },\n\n    /**\n     * Return the popover template\n     */\n    _template: function(options) {\n        return (\n            '<div class=\"ui-popover popover fade in\">' +\n            '<div class=\"arrow\"/>' +\n            '<div class=\"popover-title\">' +\n            '<div class=\"popover-title-label\"/>' +\n            '<div class=\"popover-close fa fa-times-circle\"/>' +\n            \"</div>\" +\n            '<div class=\"popover-content\"/>' +\n            \"</div>\"\n        );\n    }\n});\n\nexport default {\n    View: View\n};\n"]}