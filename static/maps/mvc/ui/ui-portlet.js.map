{"version":3,"sources":["mvc/ui/ui-portlet.js"],"names":["View","Backbone","extend","visible","initialize","options","self","model","Model","id","uid","cls","title","icon","buttons","body","scrollable","nopadding","operations","collapsible","collapsible_button","collapsed","onchange_title","set","setElement","_template","$body","$","$title","$title_text","$title_icon","$header","$content","$backdrop","$buttons","$operations","get","append","ButtonIcon","tooltip","onclick","render","attributes","$el","removeClass","addClass","attr","html","title_id","_","each","show","hide","off","on","collapse","expand","prop","make_text_editable","on_finish","new_title","empty","name","item","header","fadeIn","enableButton","find","disableButton","hideOperation","showOperation","setOperation","callback","height","setIcon","disable","enable"],"mappings":"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","file":"../../../scripts/mvc/ui/ui-portlet.js","sourcesContent":["import Utils from \"utils/utils\";\nimport Ui from \"mvc/ui/ui-misc\";\n\nexport var View = Backbone.View.extend({\n    visible: false,\n    initialize: function(options) {\n        var self = this;\n        this.model =\n            (options && options.model) ||\n            new Backbone.Model({\n                id: Utils.uid(),\n                cls: \"ui-portlet\",\n                title: \"\",\n                icon: \"\",\n                buttons: null,\n                body: null,\n                scrollable: true,\n                nopadding: false,\n                operations: null,\n                collapsible: false,\n                collapsible_button: false,\n                collapsed: false,\n                onchange_title: null\n            }).set(options);\n        this.setElement(this._template());\n\n        // link all dom elements\n        this.$body = this.$(\".portlet-body\");\n        this.$title = this.$(\".portlet-title\");\n        this.$title_text = this.$(\".portlet-title-text\");\n        this.$title_icon = this.$(\".portlet-title-icon\");\n        this.$header = this.$(\".portlet-header\");\n        this.$content = this.$(\".portlet-content\");\n        this.$backdrop = this.$(\".portlet-backdrop\");\n        this.$buttons = this.$(\".portlet-buttons\");\n        this.$operations = this.$(\".portlet-operations\");\n\n        // add body to component list\n        this.model.get(\"body\") && this.append(this.model.get(\"body\"));\n\n        // add icon for collapsible option\n        this.collapsible_button = new Ui.ButtonIcon({\n            icon: \"fa-eye\",\n            tooltip: \"Collapse/Expand\",\n            cls: \"ui-button-icon-plain\",\n            onclick: function() {\n                self[self.collapsed ? \"expand\" : \"collapse\"]();\n            }\n        });\n        this.render();\n    },\n\n    render: function() {\n        var self = this;\n        var options = this.model.attributes;\n        this.$el\n            .removeClass()\n            .addClass(options.cls)\n            .attr(\"id\", options.id);\n        this.$header[options.title ? \"show\" : \"hide\"]();\n        this.$title_text.html(options.title);\n        if (options.title_id) {\n            this.$title.attr(\"id\", options.title_id);\n        }\n        _.each([this.$content, this.$body], $el => {\n            $el[options.nopadding ? \"addClass\" : \"removeClass\"](\"no-padding\");\n        });\n\n        // render title icon\n        if (options.icon) {\n            this.$title_icon\n                .removeClass()\n                .addClass(\"portlet-title-icon fa\")\n                .addClass(options.icon)\n                .show();\n        } else {\n            this.$title_icon.hide();\n        }\n\n        // make portlet collapsible\n        this.$title_text[options.collapsible ? \"addClass\" : \"removeClass\"](\"no-highlight collapsible\").off();\n        if (options.collapsible) {\n            this.$title_text.on(\"click\", () => {\n                self[self.collapsed ? \"expand\" : \"collapse\"]();\n            });\n            options.collapsed ? this.collapse() : this.expand();\n        }\n\n        // allow title editing\n        this.$title_text.prop(\"disabled\", !options.onchange_title);\n        options.onchange_title &&\n            this.$title_text.make_text_editable({\n                on_finish: function(new_title) {\n                    options.onchange_title(new_title);\n                }\n            });\n\n        // render buttons\n        if (options.buttons) {\n            this.$buttons.empty().show();\n            $.each(this.model.get(\"buttons\"), (name, item) => {\n                item.$el.prop(\"id\", name);\n                self.$buttons.append(item.$el);\n            });\n        } else {\n            this.$buttons.hide();\n        }\n\n        // render operations\n        this.$operations.empty;\n        if (options.collapsible_button) {\n            this.$operations.append(this.collapsible_button.$el);\n        }\n        if (options.operations) {\n            $.each(options.operations, (name, item) => {\n                item.$el.prop(\"id\", name);\n                self.$operations.append(item.$el);\n            });\n        }\n        return this;\n    },\n\n    /** Append new doms to body */\n    append: function($el) {\n        this.$body.append($el);\n    },\n\n    /** Remove all content */\n    empty: function() {\n        this.$body.empty();\n    },\n\n    /** Return header element */\n    header: function() {\n        return this.$header;\n    },\n\n    /** Return body element */\n    body: function() {\n        return this.$body;\n    },\n\n    /** Show portlet */\n    show: function() {\n        this.visible = true;\n        this.$el.fadeIn(\"fast\");\n    },\n\n    /** Hide portlet */\n    hide: function() {\n        this.visible = false;\n        this.$el.hide();\n    },\n\n    /** Enable a particular button */\n    enableButton: function(id) {\n        this.$buttons.find(`#${id}`).prop(\"disabled\", false);\n    },\n\n    /** Disable a particular button */\n    disableButton: function(id) {\n        this.$buttons.find(`#${id}`).prop(\"disabled\", true);\n    },\n\n    /** Hide a particular operation */\n    hideOperation: function(id) {\n        this.$operations.find(`#${id}`).hide();\n    },\n\n    /** Show a particular operation */\n    showOperation: function(id) {\n        this.$operations.find(`#${id}`).show();\n    },\n\n    /** Replaces the event callback of an existing operation */\n    setOperation: function(id, callback) {\n        this.$operations\n            .find(`#${id}`)\n            .off(\"click\")\n            .on(\"click\", callback);\n    },\n\n    /** Change title */\n    title: function(new_title) {\n        new_title && this.$title_text.html(new_title);\n        return this.$title_text.html();\n    },\n\n    /** Collapse portlet */\n    collapse: function() {\n        this.collapsed = true;\n        this.$content.height(\"0%\");\n        this.$body.hide();\n        this.collapsible_button.setIcon(\"fa-eye-slash\");\n    },\n\n    /** Expand portlet */\n    expand: function() {\n        this.collapsed = false;\n        this.$content.height(\"100%\");\n        this.$body.fadeIn(\"fast\");\n        this.collapsible_button.setIcon(\"fa-eye\");\n    },\n\n    /** Disable content access */\n    disable: function() {\n        this.$backdrop.show();\n    },\n\n    /** Enable content access */\n    enable: function() {\n        this.$backdrop.hide();\n    },\n\n    _template: function() {\n        return $(\"<div/>\")\n            .append(\n                $(\"<div/>\")\n                    .addClass(\"portlet-header\")\n                    .append($(\"<div/>\").addClass(\"portlet-operations\"))\n                    .append(\n                        $(\"<div/>\")\n                            .addClass(\"portlet-title\")\n                            .append($(\"<i/>\").addClass(\"portlet-title-icon\"))\n                            .append($(\"<span/>\").addClass(\"portlet-title-text\"))\n                    )\n            )\n            .append(\n                $(\"<div/>\")\n                    .addClass(\"portlet-content\")\n                    .append($(\"<div/>\").addClass(\"portlet-body\"))\n                    .append($(\"<div/>\").addClass(\"portlet-buttons\"))\n            )\n            .append($(\"<div/>\").addClass(\"portlet-backdrop\"));\n    }\n});\nexport default {\n    View: View\n};\n"]}