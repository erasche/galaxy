{"version":3,"sources":["mvc/ui/ui-modal.js"],"names":["View","Backbone","extend","className","optionsDefault","container","title","cls","body","backdrop","height","width","xlarge","closing_events","closing_callback","title_separator","buttonList","initialize","options","_","defaults","$","prepend","el","render","show","visible","$el","fadeIn","document","on","e","keyCode","hide","$backdrop","canceled","fadeOut","off","self","html","_template","$header","$dialog","$body","$footer","$buttons","removeClass","addClass","find","empty","buttons","counter","each","name","callback","$button","attr","text","click","append","removeAttr","css","window","getButton","enableButton","prop","disableButton","showButton","hideButton","scrollTop"],"mappings":"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","file":"../../../scripts/mvc/ui/ui-modal.js","sourcesContent":["export var View = Backbone.View.extend({\n    className: \"ui-modal\",\n\n    // defaults\n    optionsDefault: {\n        container: \"body\",\n        title: \"ui-modal\",\n        cls: \"ui-modal\",\n        body: \"\",\n        backdrop: true,\n        height: null,\n        width: null,\n        xlarge: false /* BS4 max-width already expanded in Galaxy, expand even more if true. */,\n        closing_events: false,\n        closing_callback: null,\n        title_separator: true\n    },\n\n    // button list\n    buttonList: {},\n\n    // initialize\n    initialize: function(options) {\n        this.options = _.defaults(options || {}, this.optionsDefault);\n        $(this.options.container).prepend(this.el);\n        // optional render\n        if (options) {\n            this.render();\n        }\n    },\n\n    /**\n     * Displays modal\n     */\n    show: function(options) {\n        if (options) {\n            this.options = _.defaults(options, this.optionsDefault);\n            this.render();\n        }\n        if (!this.visible) {\n            this.visible = true;\n            this.$el.fadeIn(\"fast\");\n        }\n        if (this.options.closing_events) {\n            $(document).on(\"keyup.ui-modal\", e => {\n                if (e.keyCode == 27) {\n                    this.hide(true);\n                }\n            });\n            this.$backdrop.on(\"click\", () => {\n                this.hide(true);\n            });\n        }\n    },\n\n    /**\n     * Hide modal\n     */\n    hide: function(canceled) {\n        this.visible = false;\n        this.$el.fadeOut(\"fast\");\n        if (this.options.closing_callback) {\n            this.options.closing_callback(canceled);\n        }\n        $(document).off(\"keyup.ui-modal\");\n        this.$backdrop.off(\"click\");\n    },\n\n    /**\n     * Render modal\n     */\n    render: function() {\n        var self = this;\n        this.$el.html(this._template());\n\n        // link elements\n        this.$header = this.$(\".modal-header\");\n        this.$dialog = this.$(\".modal-dialog\");\n        this.$body = this.$(\".modal-body\");\n        this.$footer = this.$(\".modal-footer\");\n        this.$backdrop = this.$(\".modal-backdrop\");\n        this.$buttons = this.$(\".buttons\");\n\n        if (this.options.body == \"progress\") {\n            this.options.body = $(\n                '<div class=\"progress progress-striped active\">' +\n                    '<div class=\"progress-bar progress-bar-info\" style=\"width:100%\"/>' +\n                    \"</div>\"\n            );\n        }\n\n        // fix main content\n        this.$el\n            .removeClass()\n            .addClass(\"modal\")\n            .addClass(this.options.cls);\n        this.$header.find(\".title\").html(this.options.title);\n        this.$body.html(this.options.body);\n\n        // append buttons\n        this.$buttons.empty();\n        this.buttonList = {};\n        if (this.options.buttons) {\n            var counter = 0;\n            $.each(this.options.buttons, (name, callback) => {\n                var $button = $(\"<button/>\")\n                    .attr(\"id\", `button-${counter++}`)\n                    .text(name)\n                    .click(callback);\n                self.$buttons.append($button).append(\"&nbsp;\");\n                self.buttonList[name] = $button;\n            });\n        } else {\n            this.$footer.hide();\n        }\n\n        // configure background, separator line\n        this.$backdrop[(this.options.backdrop && \"addClass\") || \"removeClass\"](\"in\");\n        this.$header[(!this.options.title_separator && \"addClass\") || \"removeClass\"](\"no-separator\");\n\n        // fix dimensions\n        // note: because this is a singleton, we need to clear inline styles from any previous invocations\n        this.$body.removeAttr(\"style\");\n        if (this.options.height) {\n            this.$body.css(\"height\", this.options.height);\n            this.$body.css(\"overflow\", \"hidden\");\n        } else {\n            this.$body.css(\"max-height\", $(window).height() / 2);\n        }\n        if (this.options.width) {\n            this.$dialog.css(\"width\", this.options.width);\n        }\n        if (this.options.xlarge) {\n            this.$dialog.css(\"max-width\", \"3000px\");\n        }\n    },\n\n    /**\n     * Returns the button dom\n     * @param{String}   name    - Button name/title\n     */\n    getButton: function(name) {\n        return this.buttonList[name];\n    },\n\n    /**\n     * Enables a button\n     * @param{String}   name    - Button name/title\n     */\n    enableButton: function(name) {\n        this.getButton(name).prop(\"disabled\", false);\n    },\n\n    /**\n     * Disables a button\n     * @param{String}   name    - Button name/title\n     */\n    disableButton: function(name) {\n        this.getButton(name).prop(\"disabled\", true);\n    },\n\n    /**\n     * Show a button\n     * @param{String}   name    - Button name/title\n     */\n    showButton: function(name) {\n        this.getButton(name).show();\n    },\n\n    /**\n     * Hide a button\n     * @param{String}   name    - Button name/title\n     */\n    hideButton: function(name) {\n        this.getButton(name).hide();\n    },\n\n    /**\n     * Returns scroll top for body element\n     */\n    scrollTop: function() {\n        return this.$body.scrollTop();\n    },\n\n    /**\n     * Returns the modal template\n     */\n    _template: function() {\n        return (\n            '<div class=\"modal-backdrop fade\"/>' +\n            '<div class=\"modal-dialog\">' +\n            '<div class=\"modal-content\">' +\n            '<div class=\"modal-header\">' +\n            '<h4 class=\"title\"/>' +\n            \"</div>\" +\n            '<div class=\"modal-body\"/>' +\n            '<div class=\"modal-footer\">' +\n            '<div class=\"buttons\"/>' +\n            \"</div>\" +\n            \"</div>\" +\n            \"</div>\"\n        );\n    }\n});\n\nexport default {\n    View: View\n};\n"]}