{"version":3,"sources":["mvc/upload/upload-utils.js"],"names":["AUTO_EXTENSION","id","text","description","DEFAULT_GENOME","DEFAULT_EXTENSION","getUploadDatatypes","callback","datatypesDisableAuto","auto","get","url","Galaxy","root","success","datatypes","listExtensions","key","push","extension","description_url","composite_files","sort","a","b","a_text","toLowerCase","b_text","unshift","getUploadGenomes","defaultGenome","genomes","listGenomes","getRemoteFiles","error","$","ajax","method"],"mappings":";;;;;;;;;;;;;;;AAEA,QAAMA,iBAAiB;AACnBC,YAAI,MADe;AAEnBC,cAAM,aAFa;AAGnBC,qBACI;AAJe,KAAvB;AAMA,QAAMC,iBAAiB,GAAvB;AACA,QAAMC,oBAAoB,MAA1B;;AAEA,aAASC,kBAAT,CAA4BC,QAA5B,EAAsCC,oBAAtC,EAA4DC,IAA5D,EAAkE;AAC9D,wBAAMC,GAAN,CAAU;AACNC,iBAAQC,OAAOC,IAAf,uCADM;AAENC,qBAAS,iBAASC,SAAT,EAAoB;AACzB,oBAAMC,iBAAiB,EAAvB;AACA,qBAAK,IAAIC,GAAT,IAAgBF,SAAhB,EAA2B;AACvBC,mCAAeE,IAAf,CAAoB;AAChBjB,4BAAIc,UAAUE,GAAV,EAAeE,SADH;AAEhBjB,8BAAMa,UAAUE,GAAV,EAAeE,SAFL;AAGhBhB,qCAAaY,UAAUE,GAAV,EAAed,WAHZ;AAIhBiB,yCAAiBL,UAAUE,GAAV,EAAeG,eAJhB;AAKhBC,yCAAiBN,UAAUE,GAAV,EAAeI;AALhB,qBAApB;AAOH;AACDL,+BAAeM,IAAf,CAAoB,UAACC,CAAD,EAAIC,CAAJ,EAAU;AAC1B,wBAAIC,SAASF,EAAErB,IAAF,IAAUqB,EAAErB,IAAF,CAAOwB,WAAP,EAAvB;AACA,wBAAIC,SAASH,EAAEtB,IAAF,IAAUsB,EAAEtB,IAAF,CAAOwB,WAAP,EAAvB;AACA,2BAAOD,SAASE,MAAT,GAAkB,CAAlB,GAAsBF,SAASE,MAAT,GAAkB,CAAC,CAAnB,GAAuB,CAApD;AACH,iBAJD;AAKA,oBAAI,CAACnB,oBAAL,EAA2B;AACvBQ,mCAAeY,OAAf,CAAuBnB,IAAvB;AACH;AACDF,yBAASS,cAAT;AACH;AAtBK,SAAV;AAwBH;;AAED,aAASa,gBAAT,CAA0BtB,QAA1B,EAAoCuB,aAApC,EAAmD;AAC/C,wBAAMpB,GAAN,CAAU;AACNC,iBAAQC,OAAOC,IAAf,gBADM;AAENC,qBAAS,iBAASiB,OAAT,EAAkB;AACvB,oBAAMC,cAAc,EAApB;;AAEA,qBAAK,IAAIf,GAAT,IAAgBc,OAAhB,EAAyB;AACrBC,gCAAYd,IAAZ,CAAiB;AACbjB,4BAAI8B,QAAQd,GAAR,EAAa,CAAb,CADS;AAEbf,8BAAM6B,QAAQd,GAAR,EAAa,CAAb;AAFO,qBAAjB;AAIH;AACDe,4BAAYV,IAAZ,CAAiB,UAACC,CAAD,EAAIC,CAAJ,EAAU;AACvB,wBAAID,EAAEtB,EAAF,IAAQ6B,aAAZ,EAA2B;AACvB,+BAAO,CAAC,CAAR;AACH;AACD,wBAAIN,EAAEvB,EAAF,IAAQ6B,aAAZ,EAA2B;AACvB,+BAAO,CAAP;AACH;AACD,2BAAOP,EAAErB,IAAF,GAASsB,EAAEtB,IAAX,GAAkB,CAAlB,GAAsBqB,EAAErB,IAAF,GAASsB,EAAEtB,IAAX,GAAkB,CAAC,CAAnB,GAAuB,CAApD;AACH,iBARD;AASAK,yBAASyB,WAAT;AACH;AArBK,SAAV;AAuBH;;AAED,aAASC,cAAT,CAAwBnB,OAAxB,EAAiCoB,KAAjC,EAAwC;AACpC,eAAOC,EAAEC,IAAF,CAAO;AACVzB,iBAAQC,OAAOC,IAAf,qBADU;AAEVwB,oBAAQ,KAFE;AAGVvB,qBAASA,OAHC;AAIVoB,mBAAOA;AAJG,SAAP,CAAP;AAMH;;sBAEc;AACXlC,sCADW;AAEXI,sCAFW;AAGXC,4CAHW;AAIX4B,sCAJW;AAKX3B,8CALW;AAMXuB;AANW,K","file":"../../../scripts/mvc/upload/upload-utils.js","sourcesContent":["import Utils from \"utils/utils\";\n\nconst AUTO_EXTENSION = {\n    id: \"auto\",\n    text: \"Auto-detect\",\n    description:\n        \"This system will try to detect the file type automatically. If your file is not detected properly as one of the known formats, it most likely means that it has some format problems (e.g., different number of columns on different rows). You can still coerce the system to set your data to the format you think it should be.  You can also upload compressed files, which will automatically be decompressed.\"\n};\nconst DEFAULT_GENOME = \"?\";\nconst DEFAULT_EXTENSION = \"auto\";\n\nfunction getUploadDatatypes(callback, datatypesDisableAuto, auto) {\n    Utils.get({\n        url: `${Galaxy.root}api/datatypes?extension_only=False`,\n        success: function(datatypes) {\n            const listExtensions = [];\n            for (var key in datatypes) {\n                listExtensions.push({\n                    id: datatypes[key].extension,\n                    text: datatypes[key].extension,\n                    description: datatypes[key].description,\n                    description_url: datatypes[key].description_url,\n                    composite_files: datatypes[key].composite_files\n                });\n            }\n            listExtensions.sort((a, b) => {\n                var a_text = a.text && a.text.toLowerCase();\n                var b_text = b.text && b.text.toLowerCase();\n                return a_text > b_text ? 1 : a_text < b_text ? -1 : 0;\n            });\n            if (!datatypesDisableAuto) {\n                listExtensions.unshift(auto);\n            }\n            callback(listExtensions);\n        }\n    });\n}\n\nfunction getUploadGenomes(callback, defaultGenome) {\n    Utils.get({\n        url: `${Galaxy.root}api/genomes`,\n        success: function(genomes) {\n            const listGenomes = [];\n\n            for (var key in genomes) {\n                listGenomes.push({\n                    id: genomes[key][1],\n                    text: genomes[key][0]\n                });\n            }\n            listGenomes.sort((a, b) => {\n                if (a.id == defaultGenome) {\n                    return -1;\n                }\n                if (b.id == defaultGenome) {\n                    return 1;\n                }\n                return a.text > b.text ? 1 : a.text < b.text ? -1 : 0;\n            });\n            callback(listGenomes);\n        }\n    });\n}\n\nfunction getRemoteFiles(success, error) {\n    return $.ajax({\n        url: `${Galaxy.root}api/remote_files`,\n        method: \"GET\",\n        success: success,\n        error: error\n    });\n}\n\nexport default {\n    AUTO_EXTENSION,\n    DEFAULT_GENOME,\n    DEFAULT_EXTENSION,\n    getRemoteFiles,\n    getUploadDatatypes,\n    getUploadGenomes\n};\n"]}