{"version":3,"sources":["mvc/grid/grid-shared.js"],"names":["View","Backbone","extend","initialize","options","self","markViewAsLoading","model","Model","item","get","title","active_tab","$","ajax","url","Galaxy","root","param","params","success","response","set","render","grid","attributes","$el","empty","append","_templateShared","$tmpl","shared_by_others","length","$table","_","each","it","index","display_url","username","slug","escape","toLowerCase"],"mappings":";;;;;;;;;;;;;;;;;AAAA;AAIA,QAAIA,OAAOC,SAASD,IAAT,CAAcE,MAAd,CAAqB;AAC5BC,oBAAY,oBAASC,OAAT,EAAkB;AAC1B,gBAAIC,OAAO,IAAX;AACA,uCAAiBC,iBAAjB,CAAmC,IAAnC;AACA,iBAAKC,KAAL,GAAa,IAAIN,SAASO,KAAb,CAAmBJ,OAAnB,CAAb;AACA,iBAAKK,IAAL,GAAY,KAAKF,KAAL,CAAWG,GAAX,CAAe,MAAf,CAAZ;AACA,iBAAKC,KAAL,GAAa,KAAKJ,KAAL,CAAWG,GAAX,CAAe,QAAf,CAAb;AACA,gBAAIN,WAAWA,QAAQQ,UAAvB,EAAmC;AAC/B,qBAAKA,UAAL,GAAkBR,QAAQQ,UAA1B;AACH;AACDC,cAAEC,IAAF,CAAO;AACHC,qBAAQC,OAAOC,IAAP,GAAc,KAAKR,IAA3B,SAAmC,KAAKF,KAAL,CAAWG,GAAX,CAAe,WAAf,CAAnC,SAAkEG,EAAEK,KAAF,CAAQF,OAAOG,MAAf,CAD/D;AAEHC,yBAAS,iBAASC,QAAT,EAAmB;AACxBhB,yBAAKE,KAAL,CAAWe,GAAX,CAAeD,QAAf;AACAhB,yBAAKkB,MAAL;AACH;AALE,aAAP;AAOH,SAjB2B;;AAmB5BA,gBAAQ,kBAAW;AACf,gBAAIC,OAAO,uBAAa,KAAKjB,KAAL,CAAWkB,UAAxB,CAAX;AACA,iBAAKC,GAAL,CAASC,KAAT,GAAiBC,MAAjB,CAAwBJ,KAAKE,GAA7B;AACA,iBAAKA,GAAL,CAASE,MAAT,CAAgB,KAAKC,eAAL,EAAhB;AACH,SAvB2B;;AAyB5BA,yBAAiB,2BAAW;AACxB,gBAAIxB,OAAO,IAAX;AACA,gBAAIyB,QAAQjB,qBAAmB,KAAKN,KAAL,CAAWG,GAAX,CAAe,QAAf,CAAnB,2CAAZ;AACA,gBAAIN,UAAU,KAAKG,KAAL,CAAWkB,UAAzB;AACA,gBAAIrB,QAAQ2B,gBAAR,IAA4B3B,QAAQ2B,gBAAR,CAAyBC,MAAzB,GAAkC,CAAlE,EAAqE;AACjE,oBAAIC,SAASpB,EACT,oFACI,qBADJ,GAEI,gBAFJ,GAGI,gBAHJ,GAII,OAJJ,GAKI,UANK,CAAb;AAQAqB,kBAAEC,IAAF,CAAO/B,QAAQ2B,gBAAf,EAAiC,UAACK,EAAD,EAAKC,KAAL,EAAe;AAC5C,wBAAIC,cAAiBtB,OAAOC,IAAP,GAAcZ,KAAKI,IAApC,+CACA2B,GAAGG,QADH,cAEKH,GAAGI,IAFZ;AAGAP,2BAAOL,MAAP,wBACwBU,WADxB,WACwCJ,EAAEO,MAAF,CAASL,GAAGzB,KAAZ,CADxC,qBAC0EuB,EAAEO,MAAF,CAClEL,GAAGG,QAD+D,CAD1E;AAKH,iBATD;AAUAT,sBAAMF,MAAN,CAAaK,MAAb;AACH,aApBD,MAoBO;AACHH,sBAAMF,MAAN,SAAmB,KAAKrB,KAAL,CAAWG,GAAX,CAAe,QAAf,EAAyBgC,WAAzB,EAAnB;AACH;AACD,mBAAOZ,KAAP;AACH;AArD2B,KAArB,CAAX;;sBAwDe;AACX9B,cAAMA;AADK,K","file":"../../../scripts/mvc/grid/grid-shared.js","sourcesContent":["/** This class renders the grid list with shared section. */\nimport GridView from \"mvc/grid/grid-view\";\nimport LoadingIndicator from \"ui/loading-indicator\";\n\nvar View = Backbone.View.extend({\n    initialize: function(options) {\n        var self = this;\n        LoadingIndicator.markViewAsLoading(this);\n        this.model = new Backbone.Model(options);\n        this.item = this.model.get(\"item\");\n        this.title = this.model.get(\"plural\");\n        if (options && options.active_tab) {\n            this.active_tab = options.active_tab;\n        }\n        $.ajax({\n            url: `${Galaxy.root + this.item}/${this.model.get(\"action_id\")}?${$.param(Galaxy.params)}`,\n            success: function(response) {\n                self.model.set(response);\n                self.render();\n            }\n        });\n    },\n\n    render: function() {\n        var grid = new GridView(this.model.attributes);\n        this.$el.empty().append(grid.$el);\n        this.$el.append(this._templateShared());\n    },\n\n    _templateShared: function() {\n        var self = this;\n        var $tmpl = $(`<div><br/><h2>${this.model.get(\"plural\")} shared with you by others</h2></div>`);\n        var options = this.model.attributes;\n        if (options.shared_by_others && options.shared_by_others.length > 0) {\n            var $table = $(\n                '<table class=\"colored\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\">' +\n                    '<tr class=\"header\">' +\n                    \"<th>Title</th>\" +\n                    \"<th>Owner</th>\" +\n                    \"</tr>\" +\n                    \"</table>\"\n            );\n            _.each(options.shared_by_others, (it, index) => {\n                var display_url = `${Galaxy.root + self.item}/display_by_username_and_slug?username=${\n                    it.username\n                }&slug=${it.slug}`;\n                $table.append(\n                    `<tr><td><a href=\"${display_url}\">${_.escape(it.title)}</a></td><td>${_.escape(\n                        it.username\n                    )}</td></tr>`\n                );\n            });\n            $tmpl.append($table);\n        } else {\n            $tmpl.append(`No ${this.model.get(\"plural\").toLowerCase()} have been shared with you.`);\n        }\n        return $tmpl;\n    }\n});\n\nexport default {\n    View: View\n};\n"]}